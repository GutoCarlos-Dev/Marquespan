<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Importar XLSX - Marquespan</title>

    <!-- CSS do projeto -->
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/importar-xlsx.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Biblioteca XLSX -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <!-- üü© Sidebar -->
    <div class="sidebar" id="sidebar">
        <button class="toggle-btn" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
        <img src="logo.png" alt="Logo Marquespan" class="logo">
        <div class="usuario-logado" id="usuario-logado">üë§ Ol√°, Usu√°rio</div>
        <nav>
            <a href="dashboard.html"><i class="fas fa-chart-line"></i> <span>Dashboard</span></a>
            <a href="veiculos.html"><i class="fas fa-truck"></i> <span>Ve√≠culos</span></a>
            <a href="#"><i class="fas fa-gas-pump"></i> <span>Abastecimentos</span></a>
            <div class="menu-group">
                <button class="menu-toggle">
                    <i class="fas fa-tools"></i> <span>Manuten√ß√µes</span> <i class="fas fa-caret-down"></i>
                </button>
                <div class="submenu">
                    <a href="incluir-manutencao.html">Incluir Manuten√ß√£o</a>
                    <a href="buscar-manutencao.html">Buscar Manuten√ß√£o</a>
                </div>
            </div>
            <div class="menu-group">
                <button class="menu-toggle">
                    <i class="fas fa-truck-loading"></i> <span>Carregamento</span> <i class="fas fa-caret-down"></i>
                </button>
                <div class="submenu">
                    <a href="cadastro-carregamento.html">Cadastro</a>
                    <a href="iniciar-carregamento.html">Iniciar Carregamento</a>
                    <a href="importar-xlsx.html">Importar XLSX</a>
                    <a href="buscar-carregamento.html">Buscar Carregamento</a>
                </div>
            </div>
            <a href="#"><i class="fas fa-file-invoice-dollar"></i> <span>Custos</span></a>
            <a href="usuarios.html"><i class="fas fa-users"></i> Usu√°rios</a>
            <a href="index.html"><i class="fas fa-sign-out-alt"></i> <span>Sair</span></a>
        </nav>
    </div>

    <!-- üß± Conte√∫do principal -->
    <div class="main-content">
        <header class="header">üì¶ Importar Requisi√ß√µes XLSX</header>

        <!-- Cabe√ßalho do carregamento -->
        <div class="importar-xlsx-header">
            <h2>üì§ Importar Requisi√ß√µes de Equipamentos</h2>
            <p class="subtitle">Fa√ßa upload dos arquivos XLSX para processar as requisi√ß√µes</p>
        </div>

        <!-- Formul√°rio de dados do carregamento -->
        <div class="importar-xlsx-form">
            <div class="form-grid">
                <div class="form-group">
                    <label for="semana">Semana:</label>
                    <input type="text" id="semana" placeholder="N√∫mero da Semana">
                </div>
                <div class="form-group">
                    <label for="data">Data:</label>
                    <input type="date" id="data">
                </div>
                <div class="form-group">
                    <label for="placa">Placa:</label>
                    <input type="text" id="placa" placeholder="Placa do Ve√≠culo">
                </div>
                <div class="form-group">
                    <label for="motorista">Motorista:</label>
                    <input type="text" id="motorista" placeholder="Nome do Motorista">
                </div>
                <div class="form-group">
                    <label for="conferente">Conferente:</label>
                    <input type="text" id="conferente" placeholder="Usu√°rio logado" disabled>
                </div>
                <div class="form-group">
                    <label for="supervisor">Supervisor:</label>
                    <select id="supervisor">
                        <option value="">Selecione...</option>
                        <option>ALEXANDRE</option>
                        <option>IAMARINO</option>
                        <option>CLAUDINEI</option>
                        <option>CLEITON</option>
                        <option>EDUARDO</option>
                        <option>JADILSON</option>
                        <option>JONATHAN</option>
                        <option>LEANDRO</option>
                        <option>MARCOS</option>
                        <option>MAURO</option>
                        <option>RAFAEL</option>
                        <option>RUI</option>
                        <option>SERGIO</option>
                        <option>WUILISMAR</option>
                        <option>WASHINGTON</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Se√ß√£o de upload -->
        <div class="upload-section">
            <h3>üìÅ Selecionar Arquivos XLSX</h3>
            <div class="file-input-container">
                <input type="file" id="fileUpload" multiple accept=".xlsx">
            </div>
        </div>

        <!-- Bot√£o atualizar -->
        <div class="update-button-container">
            <button class="btn-atualizar" id="btnAtualizar">
                <i class="fas fa-sync-alt"></i> Atualizar Totais
            </button>
        </div>

        <!-- Tabelas de dados -->
        <div id="tables"></div>

        <!-- Resumo -->
        <div id="resumo"></div>

        <footer class="footer">
            &copy; 2025 Marquespan. Todos os direitos reservados.
        </footer>
    </div>

    <!-- üöÄ Scripts -->
    <script>
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('collapsed');
        }

        document.addEventListener('DOMContentLoaded', () => {
            const usuario = JSON.parse(localStorage.getItem('usuarioLogado'));
            const divUsuario = document.getElementById('usuario-logado');
            if (usuario && usuario.nome) {
                divUsuario.textContent = `üë§ Ol√°, ${usuario.nome}`;
            }
        });

        document.querySelectorAll('.menu-toggle').forEach(btn => {
            btn.addEventListener('click', () => {
                btn.parentElement.classList.toggle('active');
            });
        });
    </script>

    <script type="module" src="./script/importar-xlsx.js"></script>

</body>
</html>
