<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Coletar KM - Marquespan</title>
  <link rel="stylesheet" href="css/index.css" />
  <link rel="stylesheet" href="css/coletar-KM.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <!-- Biblioteca para Importa√ß√£o/Exporta√ß√£o Excel -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <!-- Bibliotecas para Exporta√ß√£o PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
  <link rel="icon" href="logo.png" type="image/png">
</head>
<body>
  <!-- Container para inje√ß√£o do Menu Lateral -->
  <div id="menu-container"></div>

  <!-- üß± Conte√∫do principal -->
  <main class="main-content">
    <header class="header glass-header" style="display: flex; justify-content: space-between; align-items: center;">
      <h1><i class="fas fa-tachometer-alt"></i> Coleta de Quilometragem</h1>
      <a href="mobile-coletar-km.html" class="btn-glass btn-blue" style="font-size: 0.9rem; padding: 8px 15px; text-decoration: none; color: white; border-radius: 12px;"><i class="fas fa-mobile-alt"></i> Modo App</a>
    </header>

    <!-- Grid de Cards Superiores -->
    <div class="top-cards-grid">
        <!-- Card de Informa√ß√µes -->
        <section class="glass-panel">
          <h3><i class="fas fa-info-circle"></i> Informa√ß√µes da Coleta</h3>
            <form id="formCabecalhoColeta" class="form-grid-header">
              <div class="form-group">
                <label for="coletaData">Data da Coleta</label>
                <input type="datetime-local" id="coletaData" required class="glass-input">
              </div>
              <div class="form-group">
                <label for="coletaResponsavel">Respons√°vel</label>
                <input type="text" id="coletaResponsavel" readonly class="glass-input">
              </div>
            </form>
        </section>

        <!-- Card de A√ß√µes -->
        <section class="glass-panel">
          <h3><i class="fas fa-cogs"></i> A√ß√µes</h3>
          <div class="actions-body">
            <input type="file" id="importFile" accept=".xlsx, .xls" style="display: none;">
            <button type="button" id="btnImportar" class="btn-glass btn-blue"><i class="fas fa-file-import"></i> Importar</button>
            <button type="button" id="btnExportar" class="btn-glass btn-green"><i class="fas fa-file-export"></i> Exportar XLSX</button>
            <button type="button" id="btnExportarPDF" class="btn-glass btn-red"><i class="fas fa-file-pdf"></i> Exportar PDF</button>
          </div>
        </section>
    </div>

    <!-- Card de Adicionar Ve√≠culo -->
    <section class="glass-panel">
      <h3><i class="fas fa-plus-circle"></i> Adicionar Ve√≠culo</h3>
      <form id="formItemColeta">
        <div class="form-grid-item">
          <div class="form-group">
            <label for="itemPlaca">Placa</label>
            <input type="text" id="itemPlaca" list="listaVeiculos" placeholder="Digite a placa..." required autocomplete="off" class="glass-input">
            <datalist id="listaVeiculos"></datalist>
          </div>
          <div class="form-group">
            <label for="itemModelo">Modelo</label>
            <input type="text" id="itemModelo" readonly placeholder="Autom√°tico" class="glass-input">
          </div>
          <div class="form-group">
            <label for="itemKmAnterior">KM Anterior</label>
            <input type="number" id="itemKmAnterior" placeholder="0" inputmode="numeric" class="glass-input">
          </div>
          <div class="form-group">
            <label for="itemKmProxima">KM Pr√≥xima Troca</label>
            <input type="number" id="itemKmProxima" placeholder="0" inputmode="numeric" class="glass-input">
          </div>
          <div class="form-group">
            <label for="itemKmAtual">KM Atual</label>
            <input type="number" id="itemKmAtual" required placeholder="0" inputmode="numeric" class="glass-input">
          </div>

          <div class="form-group full-width">
            <label for="itemObservacao">Observa√ß√£o</label>
            <input type="text" id="itemObservacao" placeholder="Observa√ß√µes gerais..." class="glass-input">
          </div>
        </div>
        <div class="form-actions" style="margin-top: 15px;">
          <button type="submit" class="btn-glass btn-green"><i class="fas fa-plus"></i> Adicionar</button>
        </div>
      </form>
    </section>

    <!-- Grid de Itens Coletados -->
    <section class="glass-panel">
      <h3><i class="fas fa-list"></i> Itens Coletados (<span id="contadorItens">0</span>)</h3>
      
      <div style="margin-bottom: 15px;">
        <input type="text" id="searchItemColetado" placeholder="üîç Buscar placa na lista..." autocomplete="off" class="glass-input">
      </div>
      <div class="table-responsive table-scroll-container">
        <table class="glass-table data-grid">
          <thead>
            <tr>
              <th class="sortable" data-sort="placa">PLACA <i class="fas fa-sort"></i></th>
              <th class="sortable" data-sort="modelo">MODELO <i class="fas fa-sort"></i></th>
              <th class="sortable" data-sort="km_anterior">KM ANT. <i class="fas fa-sort"></i></th>
              <th class="sortable" data-sort="km_atual">KM ATUAL <i class="fas fa-sort"></i></th>
              <th class="sortable" data-sort="km_proxima_troca">PR√ìX. TROCA <i class="fas fa-sort"></i></th>
              <th class="sortable" data-sort="observacao">OBSERVA√á√ÉO <i class="fas fa-sort"></i></th>
              <th>A√á√ïES</th>
            </tr>
          </thead>
          <tbody id="tableBodyItens">
            <!-- Preenchido via JS -->
          </tbody>
        </table>
      </div>
      <div class="card-footer-actions" style="margin-top: 20px; display: flex; justify-content: flex-end; gap: 10px;">
        <button type="button" id="btnCancelarColeta" class="btn-glass btn-red"><i class="fas fa-times"></i> CANCELAR</button>
        <button type="button" id="btnSalvarColeta" class="btn-glass btn-green"><i class="fas fa-save"></i> SALVAR COLETA COMPLETA</button>
      </div>
    </section>

    <!-- Grid de Hist√≥rico de Coletas Salvas -->
    <section class="glass-panel">
      <div class="panel-header-actions">
        <h3><i class="fas fa-history"></i> Hist√≥rico de Coletas Salvas</h3>
        <button id="btnAtualizarHistoricoDesktop" class="btn-glass btn-blue" style="padding: 6px 12px; font-size: 0.8rem;"><i class="fas fa-sync-alt"></i> Atualizar</button>
      </div>
      <div class="table-responsive">
        <table class="glass-table data-grid">
          <thead>
            <tr>
              <th>DATA</th>
              <th>RESPONS√ÅVEL</th>
              <th>QTD. VE√çCULOS</th>
              <th>A√á√ïES</th>
            </tr>
          </thead>
          <tbody id="tableBodyHistorico">
            <!-- Preenchido via JS -->
          </tbody>
        </table>
      </div>
    </section>
  </main>

  <!-- ü¶∂ Rodap√© -->
  <footer class="footer">
    &copy; 2025 Marquespan. Todos os direitos reservados.
  </footer>

  <script type="module" src="./script/menu.js"></script>
  <script type="module" src="./script/coletar-KM.js"></script>
</body>
</html>
