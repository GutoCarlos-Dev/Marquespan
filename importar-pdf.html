<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Importar PDF - Marquespan</title>
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/importar-pdf.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- üü© Sidebar -->
    <div class="sidebar" id="sidebar">
        <button class="toggle-btn" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
        <img src="logo.png" alt="Logo Marquespan" class="logo">
        <div class="usuario-logado" id="usuario-logado">üë§ Ol√°, Usu√°rio</div>
        <nav>
            <a href="dashboard.html"><i class="fas fa-chart-line"></i> <span>Dashboard</span></a>
            <a href="veiculos.html"><i class="fas fa-truck"></i> <span>Ve√≠culos</span></a>
            <a href="#"><i class="fas fa-gas-pump"></i> <span>Abastecimentos</span></a>
            <div class="menu-group">
                <button class="menu-toggle">
                    <i class="fas fa-tools"></i> <span>Manuten√ß√µes</span> <i class="fas fa-caret-down"></i>
                </button>
                <div class="submenu">
                    <a href="incluir-manutencao.html">Incluir Manuten√ß√£o</a>
                    <a href="buscar-manutencao.html">Buscar Manuten√ß√£o</a>
                </div>
            </div>
            <div class="menu-group">
                <button class="menu-toggle">
                    <i class="fas fa-truck-loading"></i> <span>Carregamento</span> <i class="fas fa-caret-down"></i>
                </button>
                <div class="submenu">
                    <a href="cadastro-carregamento.html">Cadastro</a>
                    <a href="iniciar-carregamento.html">Iniciar Carregamento</a>
                    <a href="importar-pdf.html">Importar PDF</a>
                    <a href="buscar-carregamento.html">Buscar Carregamento</a>
                </div>
            </div>
            <a href="#"><i class="fas fa-file-invoice-dollar"></i> <span>Custos</span></a>
            <a href="usuarios.html"><i class="fas fa-users"></i> Usu√°rios</a>
            <a href="index.html"><i class="fas fa-sign-out-alt"></i> <span>Sair</span></a>
        </nav>
    </div>

    <!-- üß± Conte√∫do principal -->
    <div class="main-content">
        <header class="header">üìÑ Importar PDF - Requisi√ß√µes</header>

        <div class="upload-container">
            <div class="upload-header">
                <h2>üìã Importar Requisi√ß√£o de Equipamento</h2>
                <p>Selecione um arquivo PDF de requisi√ß√£o para extrair automaticamente os dados</p>
            </div>

            <div class="upload-area" id="uploadArea">
                <div class="upload-icon">
                    <i class="fas fa-file-pdf"></i>
                </div>
                <div class="upload-text">Arraste e solte o arquivo PDF aqui</div>
                <div class="upload-subtext">ou</div>
                <label for="fileInput" class="btn-primary">
                    <i class="fas fa-folder-open"></i>
                    Selecionar Arquivo
                </label>
                <input type="file" id="fileInput" class="file-input" accept=".pdf">
            </div>

            <div class="preview-container" id="previewContainer" style="display: none;">
                <div class="preview-header">
                    <i class="fas fa-eye preview-icon"></i>
                    <h3 class="preview-title">Visualiza√ß√£o do PDF</h3>
                </div>

                <canvas id="pdfCanvas" class="pdf-preview"></canvas>

                <div class="extracted-data" id="extractedData" style="display: none;">
                    <div class="data-header">
                        <i class="fas fa-database"></i>
                        Dados Extra√≠dos
                    </div>

                    <div class="data-content">
                        <div class="data-item">
                            <span class="data-label">Cliente:</span>
                            <span class="data-value" id="clienteValue">N√£o identificado</span>
                        </div>

                        <div class="data-item">
                            <span class="data-label">Cidade:</span>
                            <span class="data-value" id="cidadeValue">N√£o identificado</span>
                        </div>

                        <div class="data-item">
                            <span class="data-label">Data:</span>
                            <span class="data-value" id="dataValue">N√£o identificado</span>
                        </div>

                        <div class="data-item">
                            <span class="data-label">Motivo:</span>
                            <span class="data-value" id="motivoValue">N√£o identificado</span>
                        </div>

                        <div class="data-item">
                            <span class="data-label">Requerente:</span>
                            <span class="data-value" id="requerenteValue">N√£o identificado</span>
                        </div>

                        <div class="items-section">
                            <div class="items-title">
                                <i class="fas fa-boxes"></i>
                                Itens Solicitados
                            </div>

                            <table class="items-table" id="itemsTable">
                                <thead>
                                    <tr>
                                        <th>QTD</th>
                                        <th>Equipamento</th>
                                        <th>Modelo</th>
                                        <th>NOVO</th>
                                        <th>USADO</th>
                                    </tr>
                                </thead>
                                <tbody id="itemsTableBody">
                                    <tr>
                                        <td colspan="5" style="text-align: center; color: #666; padding: 30px;">
                                            <i class="fas fa-clock" style="margin-right: 10px;"></i>
                                            Nenhum item extra√≠do ainda
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="action-buttons">
                            <button class="btn-primary" id="btnImportData">
                                <i class="fas fa-download"></i>
                                Importar Dados
                            </button>
                            <button class="btn-secondary" id="btnClear">
                                <i class="fas fa-trash"></i>
                                Limpar
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <footer class="footer">
            ¬© 2025 Marquespan. Todos os direitos reservados.
        </footer>
    </div>

    <div class="loading" id="loading">
        <div class="loading-content">
            <div class="spinner"></div>
            <p style="color: #2e7d32; font-weight: bold;">Processando PDF...</p>
        </div>
    </div>

    <!-- PDF.js library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js"></script>
    <script src="script/supabase.js"></script>
    <script src="script/importar-pdf.js"></script>

    <!-- üöÄ Scripts -->
    <script>
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('collapsed');
        }

        document.addEventListener('DOMContentLoaded', () => {
            const usuario = JSON.parse(localStorage.getItem('usuarioLogado'));
            const divUsuario = document.getElementById('usuario-logado');
            if (usuario && usuario.nome) {
                divUsuario.textContent = `üë§ Ol√°, ${usuario.nome}`;
            }
        });

        document.querySelectorAll('.menu-toggle').forEach(btn => {
            btn.addEventListener('click', () => {
                btn.parentElement.classList.toggle('active');
            });
        });
    </script>
</body>
</html>
