<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle de Compras - Frota Pesada</title>
    <link rel="stylesheet" href="css/stylecompras.css">
</head>
<body>
    <header>
        <img src="logo.png" alt="Logo da Empresa" class="logo">
        <h1>Controle de Compras - Frota Pesada</h1>
    </header>
    
    <nav id="menu">
        <a href="#sectionCadastrarCompras" id="btnCadastrarCompras" role="button">Cadastrar Compras</a>
        <a href="#sectionCotacoesSalvas" id="btnCotacoesSalvas" role="button">Cotações Salvas</a>
        <a href="#sectionRealizarCotacoes" id="btnRealizarCotacoes" role="button">Realizar Cotações</a>
        <a href="#sectionCadastrarFornecedor" id="btnCadastrarFornecedor" role="button">Cadastrar Fornecedor</a>
        <a href="#sectionDatabase" id="btnDatabase" role="button">Banco de Dados</a>
        <a href="#sectionCadastrarProdutos" id="btnCadastrarProdutos" role="button">Cadastrar Produtos</a>
    </nav>
    
    <main>
        <section id="sectionCadastrarCompras" class="section">
            <h2>Cadastrar Compras</h2>
            <div class="upload-section">
                <label for="excelFile">Carregar Planilha Excel:</label>
                <input type="file" id="excelFile" accept=".xlsx">
            </div>
            <form id="excelForm">
                <div class="card-row">
                    <div class="card">
                        <h3>Informações Básicas</h3>
                        <label for="nPedido">Nº PEDIDO:</label>
                        <input type="text" id="nPedido" required>
                        
                        <label for="data">DATA:</label>
                        <input type="date" id="data" required>
                    </div>
                    
                    <div class="card">
                        <h3>Produto</h3>
                        <label for="cod">COD:</label>
                        <input type="text" id="cod" required>
                        
                        <label for="produto">PRODUTO:</label>
                        <input type="text" id="produto" required>
                        
                        <label for="qtd">QTD:</label>
                        <input type="number" id="qtd" required>
                        
                        <label for="uni">UNI:</label>
                        <input type="text" id="uni" required>
                        
                        <label for="vUni">V.UNI:</label>
                        <input type="number" step="0.01" id="vUni" required>
                        
                        <label for="vTotal">V.TOTAL:</label>
                        <input type="number" step="0.01" id="vTotal" required>
                        
                        <label for="status">STATUS:</label>
                        <select id="status" required>
                            <option value="">Selecione</option>
                            <option value="Pendente">Pendente</option>
                            <option value="Aprovado">Aprovado</option>
                            <option value="Entregue">Entregue</option>
                        </select>
                    </div>
                    
                    <div class="card">
                        <h3>Nota Fiscal</h3>
                        <label for="nfTotal">N.F TOTAL:</label>
                        <input type="number" step="0.01" id="nfTotal">
                    </div>
                </div>
                
                <fieldset class="card">
                    <legend><h3>Orçamentos</h3></legend>
                    <div>
                        <label for="empresa1">EMPRESA 1:</label>
                        <input type="text" id="empresa1">
                        
                        <label for="orc1">1° ORÇ:</label>
                        <input type="number" step="0.01" id="orc1">
                    </div>
                    <div>
                        <label for="empresa2">EMPRESA 2:</label>
                        <input type="text" id="empresa2">
                        
                        <label for="orc2">2° ORÇ:</label>
                        <input type="number" step="0.01" id="orc2">
                    </div>
                    <div>
                        <label for="empresa3">EMPRESA 3:</label>
                        <input type="text" id="empresa3">
                        
                        <label for="orc3">3° ORÇ:</label>
                        <input type="number" step="0.01" id="orc3">
                    </div>
                </fieldset>
                
                <fieldset class="card">
                    <legend><h3>Pagamento</h3></legend>
                    <label for="valorPago">VALOR PAGO:</label>
                    <input type="number" step="0.01" id="valorPago">
                    
                    <label for="empresa">EMPRESA:</label>
                    <input type="text" id="empresa">
                </fieldset>
                
                <fieldset class="card">
                    <legend><h3>Requerente</h3></legend>
                    <label for="requerente">REQUERENTE:</label>
                    <input type="text" id="requerente">
                    
                    <label for="placa">PLACA:</label>
                    <input type="text" id="placa">
                </fieldset>

                <button type="submit" class="form-action-button btn-primary">Adicionar à Planilha</button>
            </form>
        </section>
        
        <section id="sectionCotacoesSalvas" class="section hidden">
            <h2>Cotações Salvas</h2>
            <div class="search-container">
                <label for="searchQuotation">Buscar por Código da Cotação:</label>
                <input type="search" id="searchQuotation" placeholder="Digite o código...">
                <button id="btnSearchQuotation" class="btn-inline btn-primary">Buscar</button>
            </div>
            <div class="filter-container">
                <label for="filterStatus">Filtrar por Status:</label>
                <select id="filterStatus">
                    <option value="Todas">Todas</option>
                    <option value="Pendente" selected>Pendente</option>
                    <option value="Finalizada">Finalizada</option>
                </select>
            </div>
            <div id="savedQuotationsContainer">
                <table id="savedQuotationsTable" class="data-grid">
                    <thead>
                        <tr>
                            <th scope="col">Código</th>
                            <th scope="col">Data</th>
                            <th scope="col">Vencedor</th>
                            <th scope="col">Total</th>
                            <th scope="col">Status</th>
                            <th scope="col">Ações</th>
                        </tr>
                    </thead>
                    <tbody id="savedQuotationsTableBody"></tbody>
                </table>
            </div>
        </section>
        
        <section id="sectionCadastrarFornecedor" class="section hidden">
            <h2>Cadastrar Fornecedor</h2>
            <form id="formCadastrarFornecedor">
                <div class="card">
                    <h3>Novo Fornecedor</h3>
                    <label for="fornecedorNome">Nome:</label>
                    <input type="text" id="fornecedorNome" required>

                    <label for="fornecedorTelefone">Telefone:</label>
                    <input type="text" id="fornecedorTelefone">
                </div>
                <button type="submit" id="btnSubmitFornecedor" class="form-action-button btn-primary">Cadastrar Fornecedor</button>
            </form>

            <div class="card" id="gridFornecedores">
                <h3>Fornecedores Cadastrados</h3>
                <table id="fornecedoresTable" class="data-grid">
                    <thead>
                        <tr>
                            <th scope="col">Nome</th>
                            <th scope="col">Telefone</th>
                            <th scope="col">Ações</th>
                        </tr>
                    </thead>
                    <tbody id="fornecedoresTableBody"></tbody>
                </table>
            </div>
        </section>
        
        <section id="sectionCadastrarProdutos" class="section hidden">
            <h2>Cadastrar Produtos</h2>
            <form id="formCadastrarProduto">
                <div class="card">
                    <h3>Novo Produto</h3>
                    <label for="produtoCodigo1">Código 1:</label>
                    <input type="text" id="produtoCodigo1" required>

                    <label for="produtoCodigo2">Código 2:</label>
                    <input type="text" id="produtoCodigo2">

                    <label for="produtoNome">Nome do Produto:</label>
                    <input type="text" id="produtoNome" required>
                </div>
                <button type="submit" id="btnSubmitProduto" class="form-action-button btn-primary">Cadastrar Produto</button>
                <button type="button" id="btnOpenImportExportModal" class="form-action-button btn-primary">Importar/Exportar Produtos</button>
            </form>

            <div class="card" id="gridProdutos">
                <h3>Produtos Cadastrados</h3>
                <table id="produtosTable" class="data-grid">
                    <thead>
                        <tr>
                            <th scope="col">Código 1</th>
                            <th scope="col">Código 2</th>
                            <th scope="col">Nome do Produto</th>
                            <th scope="col">Ações</th>
                        </tr>
                    </thead>
                    <tbody id="produtosTableBody"></tbody>
                </table>
            </div>
        </section>
        
        <section id="sectionRealizarCotacoes" class="section hidden">
            <h2>Realizar Cotações</h2>
            <div class="card">
                <label for="quotationCode">Código da Cotação (Pedido):</label>
                <input type="text" id="quotationCode" placeholder="Gerado automaticamente..." required readonly>
            </div>

            <div class="card">
                <h3>Adicionar Produto</h3>
                <label for="cartProductSelect">Selecione o Produto:</label>
                <select id="cartProductSelect" required>
                    <option value="">-- Carregando produtos... --</option>
                </select>

                <label for="cartQtd">QTD:</label>
                <input type="number" id="cartQtd" required>

                <button id="btnAddToCart" class="btn-inline btn-primary">Adicionar ao Carrinho</button>
            </div>

            <div class="card">
                <h3>Carrinho de Produtos</h3>
                <table id="cartTable">
                    <thead>
                        <tr>
                            <th scope="col">COD</th>
                            <th scope="col">PRODUTO</th>
                            <th scope="col">QTD</th>
                            <th scope="col">UNI</th>
                            <th scope="col">Ações</th>
                        </tr>
                    </thead>
                    <tbody id="cartBody">
                        <!-- Produtos adicionados dinamicamente -->
                    </tbody>
                </table>
                <button id="btnExportPdf" class="btn-inline btn-primary" style="margin-top: 20px;">Exportar PDF para Cotação</button>
            </div>

            <div class="card-row">
                <div class="card">
                    <div class="card-title-container">
                        <h3>Empresa 1</h3>
                        <div class="winner-selector">
                            <input type="radio" id="vencedora1" name="empresaVencedora" value="1">
                            <label for="vencedora1">Vencedora</label>
                        </div>
                    </div>
                    <label for="empresa1Cot">Nome:</label>
                    <select id="empresa1Cot" required>
                        <option value="">-- Selecione um fornecedor --</option>
                    </select>
                    <div id="precosEmpresa1">
                        <!-- Preços dinâmicos por produto -->
                    </div>
                    <label for="totalEmpresa1">Total:</label>
                    <input type="number" step="0.01" id="totalEmpresa1" readonly>
                    <label for="obsEmpresa1">OBS:</label>
                    <textarea id="obsEmpresa1" rows="2"></textarea>
                </div>

                <div class="card">
                    <div class="card-title-container">
                        <h3>Empresa 2</h3>
                        <div class="winner-selector">
                            <input type="radio" id="vencedora2" name="empresaVencedora" value="2">
                            <label for="vencedora2">Vencedora</label>
                        </div>
                    </div>
                    <label for="empresa2Cot">Nome:</label>
                    <select id="empresa2Cot" required>
                        <option value="">-- Selecione um fornecedor --</option>
                    </select>
                    <div id="precosEmpresa2">
                        <!-- Preços dinâmicos por produto -->
                    </div>
                    <label for="totalEmpresa2">Total:</label>
                    <input type="number" step="0.01" id="totalEmpresa2" readonly>
                    <label for="obsEmpresa2">OBS:</label>
                    <textarea id="obsEmpresa2" rows="2"></textarea>
                </div>

                <div class="card">
                    <div class="card-title-container">
                        <h3>Empresa 3</h3>
                        <div class="winner-selector">
                            <input type="radio" id="vencedora3" name="empresaVencedora" value="3">
                            <label for="vencedora3">Vencedora</label>
                        </div>
                    </div>
                    <label for="empresa3Cot">Nome:</label>
                    <select id="empresa3Cot" required>
                        <option value="">-- Selecione um fornecedor --</option>
                    </select>
                    <div id="precosEmpresa3">
                        <!-- Preços dinâmicos por produto -->
                    </div>
                    <label for="totalEmpresa3">Total:</label>
                    <input type="number" step="0.01" id="totalEmpresa3" readonly>
                    <label for="obsEmpresa3">OBS:</label>
                    <textarea id="obsEmpresa3" rows="2"></textarea>
                </div>
            </div>

            <button id="btnRegistrarCotacoes" class="form-action-button btn-primary">Registrar Cotações</button>
            <button id="btnFormalizarCompra" class="form-action-button btn-primary">Formalizar Compra</button>
            <div id="selecionarVencedor" style="display: none;">
                <label for="vencedor">Selecionar Empresa Vencedora:</label>
                <select id="vencedor">
                    <option value="">Selecione</option>
                </select>
            </div>
        </section>
    </main>

    <!-- Modal de Importação/Exportação -->
    <div id="importExportModal" class="modal-backdrop hidden">
        <div class="modal">
            <div class="modal-header">
                <h2>Importar/Exportar Produtos</h2>
                <button class="close-button">&times;</button>
            </div>
            <div class="modal-body">
                <div class="card">
                    <h3>Importar Produtos (Excel)</h3>
                    <p>Formato esperado: Coluna A1=COD1, B1=COD2, C1=PRODUTO</p>
                    <label for="importExcelFile">Selecionar arquivo Excel:</label>
                    <input type="file" id="importExcelFile" accept=".xlsx, .xls">
                    <button id="btnImportProducts" class="btn-primary">Importar</button>
                </div>
                <div class="card">
                    <h3>Exportar Produtos (Excel)</h3>
                    <p>Exporta todos os produtos cadastrados para uma planilha Excel.</p>
                    <button id="btnExportProducts" class="btn-primary">Exportar</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Detalhes da Cotação -->
    <div id="quotationDetailModal" class="modal-backdrop hidden">
        <div class="modal">
            <div class="modal-header">
                <h2 id="quotationDetailTitle">Detalhes da Cotação</h2>
                <button class="close-button">&times;</button>
            </div>
            <div class="modal-body" id="quotationDetailBody">
                <!-- Conteúdo dinâmico aqui -->
                <button id="btnFormalizarCompraModal" class="form-action-button btn-primary" style="display: none;">Formalizar Compra</button>
            </div>
        </div>
    </div>

    <!-- Seção do Banco de Dados -->
    <section id="sectionDatabase" class="section hidden">
        <h2>Gerenciar Banco de Dados (Excel)</h2>
        <div class="card">
            <h3>Importar Dados</h3>
            <p>Carregue o arquivo <code>database.xlsx</code> para popular todo o sistema. <strong>Atenção:</strong> Isso irá sobrescrever todos os dados atuais.</p>
            <label for="databaseFile">Selecionar arquivo de banco de dados:</label>
            <input type="file" id="databaseFile" accept=".xlsx, .xls">
            <button id="btnLoadFromDatabase" class="btn-inline btn-primary">Carregar Banco de Dados</button>
        </div>
        <div class="card">
            <h3>Exportar Dados</h3>
            <p>Salve todos os dados do sistema (produtos, fornecedores e cotações) em um único arquivo <code>database.xlsx</code>.</p>
            <button id="btnSaveToDatabase" class="btn-inline btn-primary">Salvar Banco de Dados</button>
        </div>
    </section>

    
    <script src="xlsx.min.js"></script>
    <script src="jspdf.umd.min.js"></script>
    <script src="jspdf.plugin.autotable.js"></script>
    <!-- Adicionado type="module" para permitir importações -->
    <script type="module" src="script/scriptcompras.js"></script>
</body>
</html>
